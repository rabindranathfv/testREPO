(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/material'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('material-dynamic-table', ['exports', '@angular/core', '@angular/material', '@angular/common'], factory) :
    (factory((global['material-dynamic-table'] = {}),global.ng.core,global.ng.material,global.ng.common));
}(this, (function (exports,core,material,common) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ColumnFilter = /** @class */ (function () {
        function ColumnFilter() {
        }
        return ColumnFilter;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ColumnFilterService = /** @class */ (function () {
        function ColumnFilterService() {
            this.registeredFilters = {};
        }
        /**
         * @param {?} type
         * @param {?} component
         * @return {?}
         */
        ColumnFilterService.prototype.registerFilter = /**
         * @param {?} type
         * @param {?} component
         * @return {?}
         */
            function (type, component) {
                this.registeredFilters[type] = component;
            };
        /**
         * @param {?} type
         * @return {?}
         */
        ColumnFilterService.prototype.getFilter = /**
         * @param {?} type
         * @return {?}
         */
            function (type) {
                /** @type {?} */
                var component = this.registeredFilters[type];
                return component;
            };
        return ColumnFilterService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var DynamicTableComponent = /** @class */ (function () {
        function DynamicTableComponent(columnFilterService, dialog) {
            this.columnFilterService = columnFilterService;
            this.dialog = dialog;
            this.pageSize = 20;
            this.pageSizeOptions = [20, 50, 100];
            this.showFilters = true;
            this.stickyHeader = false;
            this.appliedFilters = {};
        }
        /**
         * @return {?}
         */
        DynamicTableComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.dataSource == null) {
                    throw Error('DynamicTable must be provided with data source.');
                }
                if (this.columns == null) {
                    throw Error('DynamicTable must be provided with column definitions.');
                }
                if (this.paginator === undefined) {
                    this.paginator = this.internalPaginator;
                }
                this.displayedColumns = this.columns.map(function (column, index) { return _this.prepareColumnName(column.name, index); });
                /** @type {?} */
                var dataSource = ( /** @type {?} */(this.dataSource));
                dataSource.sort = this.sort;
                dataSource.paginator = this.paginator;
            };
        /**
         * @return {?}
         */
        DynamicTableComponent.prototype.isUsingInternalPaginator = /**
         * @return {?}
         */
            function () {
                return this.paginator === this.internalPaginator;
            };
        /**
         * @param {?} column
         * @return {?}
         */
        DynamicTableComponent.prototype.canFilter = /**
         * @param {?} column
         * @return {?}
         */
            function (column) {
                /** @type {?} */
                var filter = this.columnFilterService.getFilter(column.type);
                return filter != null;
            };
        /**
         * @param {?} column
         * @return {?}
         */
        DynamicTableComponent.prototype.isFiltered = /**
         * @param {?} column
         * @return {?}
         */
            function (column) {
                return this.appliedFilters[column.name];
            };
        /**
         * @param {?} column
         * @return {?}
         */
        DynamicTableComponent.prototype.getFilterDescription = /**
         * @param {?} column
         * @return {?}
         */
            function (column) {
                /** @type {?} */
                var filter = this.appliedFilters[column.name];
                if (!filter || !filter.getDescription) {
                    return null;
                }
                return filter.getDescription();
            };
        /**
         * @param {?} name
         * @param {?} columnNumber
         * @return {?}
         */
        DynamicTableComponent.prototype.prepareColumnName = /**
         * @param {?} name
         * @param {?} columnNumber
         * @return {?}
         */
            function (name, columnNumber) {
                return name || 'col' + columnNumber;
            };
        /**
         * @param {?} column
         * @return {?}
         */
        DynamicTableComponent.prototype.filter = /**
         * @param {?} column
         * @return {?}
         */
            function (column) {
                var _this = this;
                /** @type {?} */
                var filter = this.columnFilterService.getFilter(column.type);
                if (filter) {
                    /** @type {?} */
                    var dialogConfig = new material.MatDialogConfig();
                    /** @type {?} */
                    var columnFilter = new ColumnFilter();
                    columnFilter.column = column;
                    if (this.appliedFilters[column.name]) {
                        columnFilter.filter = Object.create(this.appliedFilters[column.name]);
                    }
                    dialogConfig.data = columnFilter;
                    /** @type {?} */
                    var dialogRef = this.dialog.open(filter, dialogConfig);
                    dialogRef.afterClosed().subscribe(function (result) {
                        if (result) {
                            _this.appliedFilters[column.name] = result;
                        }
                        else if (result === '') {
                            delete _this.appliedFilters[column.name];
                        }
                        if (result || result === '') {
                            _this.updateDataSource();
                        }
                    });
                }
            };
        /**
         * @return {?}
         */
        DynamicTableComponent.prototype.clearFilters = /**
         * @return {?}
         */
            function () {
                this.appliedFilters = {};
                this.updateDataSource();
            };
        /**
         * @protected
         * @return {?}
         */
        DynamicTableComponent.prototype.updateDataSource = /**
         * @protected
         * @return {?}
         */
            function () {
                /** @type {?} */
                var dataSource = ( /** @type {?} */(this.dataSource));
                dataSource.filters = this.getFilters();
            };
        /**
         * @return {?}
         */
        DynamicTableComponent.prototype.getFilters = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var filters = this.appliedFilters;
                /** @type {?} */
                var filterArray = Object.keys(filters).map(function (key) { return filters[key]; });
                return filterArray;
            };
        /**
         * @param {?} columnName
         * @return {?}
         */
        DynamicTableComponent.prototype.getFilter = /**
         * @param {?} columnName
         * @return {?}
         */
            function (columnName) {
                /** @type {?} */
                var filterColumn = this.getColumnByName(columnName);
                if (!filterColumn) {
                    throw Error("Column with name '" + columnName + "' does not exist.");
                }
                return this.appliedFilters[filterColumn.name];
            };
        /**
         * @param {?} columnName
         * @param {?} filter
         * @return {?}
         */
        DynamicTableComponent.prototype.setFilter = /**
         * @param {?} columnName
         * @param {?} filter
         * @return {?}
         */
            function (columnName, filter) {
                /** @type {?} */
                var filterColumn = this.getColumnByName(columnName);
                if (!filterColumn) {
                    throw Error("Cannot set filter for a column. Column with name '" + columnName + "' does not exist.");
                }
                this.appliedFilters[filterColumn.name] = filter;
                this.updateDataSource();
            };
        /**
         * @private
         * @param {?} columnName
         * @return {?}
         */
        DynamicTableComponent.prototype.getColumnByName = /**
         * @private
         * @param {?} columnName
         * @return {?}
         */
            function (columnName) {
                return this.columns.find(function (c) {
                    return (c.name ? c.name.toLowerCase() : c.name) === (columnName ? columnName.toLowerCase() : columnName);
                });
            };
        DynamicTableComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'mdt-dynamic-table',
                        template: "<table mat-table [dataSource]=\"dataSource\"\r\n       matSort matSortDirection=\"asc\">\r\n\r\n  <ng-container *ngFor=\"let column of columns; let i = index\" matColumnDef=\"{{ prepareColumnName(column.name, i) }}\"\r\n                [sticky]=\"column.sticky === 'start'\" [stickyEnd]=\"column.sticky === 'end'\">\r\n    <th mat-header-cell *matHeaderCellDef mat-sort-header=\"{{ prepareColumnName(column.name, i) }}\" [disabled]=\"!column.name || column.sort === false\">\r\n      {{ column.displayName }}\r\n      <button class=\"mat-sort-header-button\" *ngIf=\"showFilters && canFilter(column)\"\r\n              (click)=\"filter(column); $event.stopPropagation();\"\r\n              matTooltip=\"{{ getFilterDescription(column) }}\" matTooltipDisabled=\"{{ !getFilterDescription(column) }}\">\r\n        <mat-icon color=\"{{ isFiltered(column) ? 'primary' : 'default' }}\">filter_list</mat-icon>\r\n      </button>\r\n    </th>\r\n    <td mat-cell *matCellDef=\"let row\"><mdt-table-cell [row]=\"row\" [column]=\"column\"></mdt-table-cell></td>\r\n  </ng-container>\r\n\r\n  <tr mat-header-row *matHeaderRowDef=\"displayedColumns; sticky: [stickyHeader]\"></tr>\r\n  <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\r\n</table>\r\n<mat-paginator [hidden]=\"!isUsingInternalPaginator()\" [pageSize]=\"pageSize\"\r\n               [pageSizeOptions]=\"pageSizeOptions\">\r\n</mat-paginator>",
                        styles: ["table{width:100%}th .mat-icon.mat-default{opacity:.54}th .mat-icon.mat-default:hover{opacity:1}[hidden]{display:none}"]
                    }] }
        ];
        /** @nocollapse */
        DynamicTableComponent.ctorParameters = function () {
            return [
                { type: ColumnFilterService },
                { type: material.MatDialog }
            ];
        };
        DynamicTableComponent.propDecorators = {
            columns: [{ type: core.Input }],
            dataSource: [{ type: core.Input }],
            pageSize: [{ type: core.Input }],
            pageSizeOptions: [{ type: core.Input }],
            showFilters: [{ type: core.Input }],
            stickyHeader: [{ type: core.Input }],
            paginator: [{ type: core.Input }],
            sort: [{ type: core.ViewChild, args: [material.MatSort,] }],
            internalPaginator: [{ type: core.ViewChild, args: [material.MatPaginator,] }]
        };
        return DynamicTableComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var CellDirective = /** @class */ (function () {
        function CellDirective(viewContainerRef) {
            this.viewContainerRef = viewContainerRef;
        }
        CellDirective.decorators = [
            { type: core.Directive, args: [{
                        selector: '[mdtCellHost]',
                    },] }
        ];
        /** @nocollapse */
        CellDirective.ctorParameters = function () {
            return [
                { type: core.ViewContainerRef }
            ];
        };
        return CellDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var TextCellComponent = /** @class */ (function () {
        function TextCellComponent() {
        }
        TextCellComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'mdt-text-cell',
                        template: '{{ row[column.name] }}'
                    }] }
        ];
        TextCellComponent.propDecorators = {
            column: [{ type: core.Input }],
            row: [{ type: core.Input }]
        };
        return TextCellComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var CellService = /** @class */ (function () {
        function CellService() {
            this.registeredCells = {};
        }
        /**
         * @param {?} type
         * @param {?} component
         * @return {?}
         */
        CellService.prototype.registerCell = /**
         * @param {?} type
         * @param {?} component
         * @return {?}
         */
            function (type, component) {
                this.registeredCells[type] = component;
            };
        /**
         * @param {?} type
         * @return {?}
         */
        CellService.prototype.getCell = /**
         * @param {?} type
         * @return {?}
         */
            function (type) {
                /** @type {?} */
                var component = this.registeredCells[type];
                if (component == null) {
                    return TextCellComponent;
                }
                return component;
            };
        return CellService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var TableCellComponent = /** @class */ (function () {
        function TableCellComponent(cellService, componentFactoryResolver) {
            this.cellService = cellService;
            this.componentFactoryResolver = componentFactoryResolver;
        }
        /**
         * @return {?}
         */
        TableCellComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this.initCell();
            };
        /**
         * @return {?}
         */
        TableCellComponent.prototype.initCell = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var cellComponent = this.cellService.getCell(this.column.type);
                /** @type {?} */
                var componentFactory = this.componentFactoryResolver.resolveComponentFactory(cellComponent);
                /** @type {?} */
                var viewContainerRef = this.cellHost.viewContainerRef;
                viewContainerRef.clear();
                /** @type {?} */
                var componentRef = viewContainerRef.createComponent(componentFactory);
                /** @type {?} */
                var cell = ( /** @type {?} */(componentRef.instance));
                cell.row = this.row;
                cell.column = this.column;
            };
        TableCellComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'mdt-table-cell',
                        template: '<ng-template mdtCellHost></ng-template>'
                    }] }
        ];
        /** @nocollapse */
        TableCellComponent.ctorParameters = function () {
            return [
                { type: CellService },
                { type: core.ComponentFactoryResolver }
            ];
        };
        TableCellComponent.propDecorators = {
            cellHost: [{ type: core.ViewChild, args: [CellDirective,] }],
            row: [{ type: core.Input }],
            column: [{ type: core.Input }]
        };
        return TableCellComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ColumnConfig = /** @class */ (function () {
        function ColumnConfig() {
        }
        return ColumnConfig;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var DateCellComponent = /** @class */ (function () {
        function DateCellComponent() {
            this.dateFormat = 'short';
        }
        /**
         * @return {?}
         */
        DateCellComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                if (this.column.options) {
                    if (this.column.options.dateFormat) {
                        this.dateFormat = this.column.options.dateFormat;
                    }
                }
            };
        DateCellComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'mdt-date-cell',
                        template: '{{ row[column.name] | date:dateFormat }}'
                    }] }
        ];
        DateCellComponent.propDecorators = {
            column: [{ type: core.Input }],
            row: [{ type: core.Input }]
        };
        return DateCellComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var DynamicTableModule = /** @class */ (function () {
        function DynamicTableModule(cellService) {
            this.cellService = cellService;
            cellService.registerCell('string', TextCellComponent);
            cellService.registerCell('date', DateCellComponent);
        }
        DynamicTableModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule,
                            material.MatTableModule,
                            material.MatSortModule,
                            material.MatPaginatorModule,
                            material.MatIconModule,
                            material.MatDialogModule,
                            material.MatTooltipModule
                        ],
                        declarations: [
                            DynamicTableComponent,
                            TableCellComponent,
                            CellDirective,
                            TextCellComponent,
                            DateCellComponent
                        ],
                        exports: [DynamicTableComponent],
                        entryComponents: [
                            TextCellComponent,
                            DateCellComponent
                        ],
                        providers: [
                            CellService,
                            ColumnFilterService
                        ]
                    },] }
        ];
        /** @nocollapse */
        DynamicTableModule.ctorParameters = function () {
            return [
                { type: CellService }
            ];
        };
        return DynamicTableModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    exports.DynamicTableComponent = DynamicTableComponent;
    exports.CellService = CellService;
    exports.CellDirective = CellDirective;
    exports.ColumnFilterService = ColumnFilterService;
    exports.ColumnFilter = ColumnFilter;
    exports.ColumnConfig = ColumnConfig;
    exports.DynamicTableModule = DynamicTableModule;
    exports.ɵc = DateCellComponent;
    exports.ɵb = TextCellComponent;
    exports.ɵa = TableCellComponent;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0ZXJpYWwtZHluYW1pYy10YWJsZS51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL21hdGVyaWFsLWR5bmFtaWMtdGFibGUvbGliL2NvbHVtbi1maWx0ZXIubW9kZWwudHMiLCJuZzovL21hdGVyaWFsLWR5bmFtaWMtdGFibGUvbGliL3RhYmxlLWNlbGwvY2VsbC10eXBlcy9jb2x1bW4tZmlsdGVyLnNlcnZpY2UudHMiLCJuZzovL21hdGVyaWFsLWR5bmFtaWMtdGFibGUvbGliL2R5bmFtaWMtdGFibGUuY29tcG9uZW50LnRzIiwibmc6Ly9tYXRlcmlhbC1keW5hbWljLXRhYmxlL2xpYi90YWJsZS1jZWxsL2NlbGwuZGlyZWN0aXZlLnRzIiwibmc6Ly9tYXRlcmlhbC1keW5hbWljLXRhYmxlL2xpYi90YWJsZS1jZWxsL2NlbGwtdHlwZXMvdGV4dC1jZWxsLmNvbXBvbmVudC50cyIsIm5nOi8vbWF0ZXJpYWwtZHluYW1pYy10YWJsZS9saWIvdGFibGUtY2VsbC9jZWxsLXR5cGVzL2NlbGwuc2VydmljZS50cyIsIm5nOi8vbWF0ZXJpYWwtZHluYW1pYy10YWJsZS9saWIvdGFibGUtY2VsbC90YWJsZS1jZWxsLmNvbXBvbmVudC50cyIsIm5nOi8vbWF0ZXJpYWwtZHluYW1pYy10YWJsZS9saWIvY29sdW1uLWNvbmZpZy5tb2RlbC50cyIsIm5nOi8vbWF0ZXJpYWwtZHluYW1pYy10YWJsZS9saWIvdGFibGUtY2VsbC9jZWxsLXR5cGVzL2RhdGUtY2VsbC5jb21wb25lbnQudHMiLCJuZzovL21hdGVyaWFsLWR5bmFtaWMtdGFibGUvbGliL2R5bmFtaWMtdGFibGUubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbHVtbkNvbmZpZyB9IGZyb20gJy4vY29sdW1uLWNvbmZpZy5tb2RlbCc7XG5cbmV4cG9ydCBjbGFzcyBDb2x1bW5GaWx0ZXIge1xuICAgIGNvbHVtbjogQ29sdW1uQ29uZmlnO1xuICAgIGZpbHRlcjogYW55O1xufSIsImltcG9ydCB7IFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuZXhwb3J0IGNsYXNzIENvbHVtbkZpbHRlclNlcnZpY2Uge1xuXG4gICAgcHJpdmF0ZSByZWdpc3RlcmVkRmlsdGVyczogeyBba2V5OiBzdHJpbmddOiBUeXBlPGFueT47IH0gPSB7fTtcbiAgICBcbiAgICByZWdpc3RlckZpbHRlcih0eXBlOiBzdHJpbmcsIGNvbXBvbmVudDogVHlwZTxhbnk+KSB7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZEZpbHRlcnNbdHlwZV0gPSBjb21wb25lbnQ7XG4gICAgfVxuXG4gICAgZ2V0RmlsdGVyKHR5cGU6IHN0cmluZyk6IFR5cGU8YW55PiB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMucmVnaXN0ZXJlZEZpbHRlcnNbdHlwZV07XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xuICAgIH1cbn0iLCJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTWF0U29ydCwgTWF0UGFnaW5hdG9yLCBNYXREaWFsb2csIE1hdERpYWxvZ0NvbmZpZyB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCB7IERhdGFTb3VyY2UgfSBmcm9tICdAYW5ndWxhci9jZGsvdGFibGUnO1xuaW1wb3J0IHsgQ29sdW1uQ29uZmlnIH0gZnJvbSAnLi9jb2x1bW4tY29uZmlnLm1vZGVsJztcbmltcG9ydCB7IENvbHVtbkZpbHRlciB9IGZyb20gJy4vY29sdW1uLWZpbHRlci5tb2RlbCc7XG5pbXBvcnQgeyBDb2x1bW5GaWx0ZXJTZXJ2aWNlIH0gZnJvbSAnLi90YWJsZS1jZWxsL2NlbGwtdHlwZXMvY29sdW1uLWZpbHRlci5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbWR0LWR5bmFtaWMtdGFibGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vZHluYW1pYy10YWJsZS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2R5bmFtaWMtdGFibGUuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIER5bmFtaWNUYWJsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgQElucHV0KCkgY29sdW1uczogQ29sdW1uQ29uZmlnW107XG4gIEBJbnB1dCgpIGRhdGFTb3VyY2U6IERhdGFTb3VyY2U8YW55PjtcbiAgQElucHV0KCkgcGFnZVNpemUgPSAyMDtcbiAgQElucHV0KCkgcGFnZVNpemVPcHRpb25zID0gWzIwLCA1MCwgMTAwXTtcbiAgQElucHV0KCkgc2hvd0ZpbHRlcnMgPSB0cnVlO1xuICBASW5wdXQoKSBzdGlja3lIZWFkZXIgPSBmYWxzZTtcbiAgQElucHV0KCkgcGFnaW5hdG9yOiBNYXRQYWdpbmF0b3I7XG5cbiAgZGlzcGxheWVkQ29sdW1uczogc3RyaW5nW107XG5cbiAgQFZpZXdDaGlsZChNYXRTb3J0KSBzb3J0OiBNYXRTb3J0O1xuICBAVmlld0NoaWxkKE1hdFBhZ2luYXRvcikgcHJpdmF0ZSBpbnRlcm5hbFBhZ2luYXRvcjogTWF0UGFnaW5hdG9yO1xuXG4gIHByaXZhdGUgYXBwbGllZEZpbHRlcnM6IHsgW2tleTogc3RyaW5nXTogYW55OyB9ID0ge307XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBjb2x1bW5GaWx0ZXJTZXJ2aWNlOiBDb2x1bW5GaWx0ZXJTZXJ2aWNlLCBwcml2YXRlIHJlYWRvbmx5IGRpYWxvZzogTWF0RGlhbG9nKSB7IH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBpZiAodGhpcy5kYXRhU291cmNlID09IG51bGwpIHtcbiAgICAgIHRocm93IEVycm9yKCdEeW5hbWljVGFibGUgbXVzdCBiZSBwcm92aWRlZCB3aXRoIGRhdGEgc291cmNlLicpO1xuICAgIH1cbiAgICBpZiAodGhpcy5jb2x1bW5zID09IG51bGwpIHtcbiAgICAgIHRocm93IEVycm9yKCdEeW5hbWljVGFibGUgbXVzdCBiZSBwcm92aWRlZCB3aXRoIGNvbHVtbiBkZWZpbml0aW9ucy4nKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wYWdpbmF0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5wYWdpbmF0b3IgPSB0aGlzLmludGVybmFsUGFnaW5hdG9yO1xuICAgIH1cblxuICAgIHRoaXMuZGlzcGxheWVkQ29sdW1ucyA9IHRoaXMuY29sdW1ucy5tYXAoKGNvbHVtbiwgaW5kZXgpID0+IHRoaXMucHJlcGFyZUNvbHVtbk5hbWUoY29sdW1uLm5hbWUsIGluZGV4KSk7XG5cbiAgICBjb25zdCBkYXRhU291cmNlID0gdGhpcy5kYXRhU291cmNlIGFzIGFueTtcbiAgICBkYXRhU291cmNlLnNvcnQgPSB0aGlzLnNvcnQ7XG4gICAgZGF0YVNvdXJjZS5wYWdpbmF0b3IgPSB0aGlzLnBhZ2luYXRvcjtcbiAgfVxuXG4gIGlzVXNpbmdJbnRlcm5hbFBhZ2luYXRvcigpIHtcbiAgICByZXR1cm4gdGhpcy5wYWdpbmF0b3IgPT09IHRoaXMuaW50ZXJuYWxQYWdpbmF0b3I7XG4gIH1cblxuICBjYW5GaWx0ZXIoY29sdW1uOiBDb2x1bW5Db25maWcpIHtcbiAgICBjb25zdCBmaWx0ZXIgPSB0aGlzLmNvbHVtbkZpbHRlclNlcnZpY2UuZ2V0RmlsdGVyKGNvbHVtbi50eXBlKTtcblxuICAgIHJldHVybiBmaWx0ZXIgIT0gbnVsbDtcbiAgfVxuXG4gIGlzRmlsdGVyZWQoY29sdW1uOiBDb2x1bW5Db25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBsaWVkRmlsdGVyc1tjb2x1bW4ubmFtZV07XG4gIH1cblxuICBnZXRGaWx0ZXJEZXNjcmlwdGlvbihjb2x1bW46IENvbHVtbkNvbmZpZykge1xuICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuYXBwbGllZEZpbHRlcnNbY29sdW1uLm5hbWVdO1xuICAgIGlmICghZmlsdGVyIHx8ICFmaWx0ZXIuZ2V0RGVzY3JpcHRpb24pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBmaWx0ZXIuZ2V0RGVzY3JpcHRpb24oKTtcbiAgfVxuXG4gIHByZXBhcmVDb2x1bW5OYW1lKG5hbWU6IHN0cmluZywgY29sdW1uTnVtYmVyOiBudW1iZXIpIHtcbiAgICByZXR1cm4gbmFtZSB8fCAnY29sJyArIGNvbHVtbk51bWJlcjtcbiAgfVxuXG4gIGZpbHRlcihjb2x1bW46IENvbHVtbkNvbmZpZykge1xuICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuY29sdW1uRmlsdGVyU2VydmljZS5nZXRGaWx0ZXIoY29sdW1uLnR5cGUpO1xuXG4gICAgaWYgKGZpbHRlcikge1xuICAgICAgY29uc3QgZGlhbG9nQ29uZmlnID0gbmV3IE1hdERpYWxvZ0NvbmZpZygpO1xuICAgICAgY29uc3QgY29sdW1uRmlsdGVyID0gbmV3IENvbHVtbkZpbHRlcigpO1xuICAgICAgY29sdW1uRmlsdGVyLmNvbHVtbiA9IGNvbHVtbjtcblxuICAgICAgaWYgKHRoaXMuYXBwbGllZEZpbHRlcnNbY29sdW1uLm5hbWVdKSB7XG4gICAgICAgIGNvbHVtbkZpbHRlci5maWx0ZXIgPSBPYmplY3QuY3JlYXRlKHRoaXMuYXBwbGllZEZpbHRlcnNbY29sdW1uLm5hbWVdKTtcbiAgICAgIH1cblxuICAgICAgZGlhbG9nQ29uZmlnLmRhdGEgPSBjb2x1bW5GaWx0ZXI7XG5cbiAgICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oZmlsdGVyLCBkaWFsb2dDb25maWcpO1xuXG4gICAgICBkaWFsb2dSZWYuYWZ0ZXJDbG9zZWQoKS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIHRoaXMuYXBwbGllZEZpbHRlcnNbY29sdW1uLm5hbWVdID0gcmVzdWx0O1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdCA9PT0gJycpIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5hcHBsaWVkRmlsdGVyc1tjb2x1bW4ubmFtZV07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVzdWx0IHx8IHJlc3VsdCA9PT0gJycpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFTb3VyY2UoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJGaWx0ZXJzKCkge1xuICAgIHRoaXMuYXBwbGllZEZpbHRlcnMgPSB7fTtcbiAgICB0aGlzLnVwZGF0ZURhdGFTb3VyY2UoKTtcbiAgfVxuXG4gIHByb3RlY3RlZCB1cGRhdGVEYXRhU291cmNlKCkge1xuICAgIGNvbnN0IGRhdGFTb3VyY2UgPSB0aGlzLmRhdGFTb3VyY2UgYXMgYW55O1xuICAgIGRhdGFTb3VyY2UuZmlsdGVycyA9IHRoaXMuZ2V0RmlsdGVycygpO1xuICB9XG5cbiAgZ2V0RmlsdGVycygpIHtcbiAgICBjb25zdCBmaWx0ZXJzID0gdGhpcy5hcHBsaWVkRmlsdGVycztcbiAgICBjb25zdCBmaWx0ZXJBcnJheSA9IE9iamVjdC5rZXlzKGZpbHRlcnMpLm1hcCgoa2V5KSA9PiBmaWx0ZXJzW2tleV0pO1xuICAgIHJldHVybiBmaWx0ZXJBcnJheTtcbiAgfVxuXG4gIGdldEZpbHRlcihjb2x1bW5OYW1lOiBzdHJpbmcpOiBhbnkge1xuICAgIGNvbnN0IGZpbHRlckNvbHVtbiA9IHRoaXMuZ2V0Q29sdW1uQnlOYW1lKGNvbHVtbk5hbWUpO1xuXG4gICAgaWYgKCFmaWx0ZXJDb2x1bW4pIHtcbiAgICAgIHRocm93IEVycm9yKGBDb2x1bW4gd2l0aCBuYW1lICcke2NvbHVtbk5hbWV9JyBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5hcHBsaWVkRmlsdGVyc1tmaWx0ZXJDb2x1bW4ubmFtZV07XG4gIH1cblxuICBzZXRGaWx0ZXIoY29sdW1uTmFtZTogc3RyaW5nLCBmaWx0ZXI6IGFueSkge1xuICAgIGNvbnN0IGZpbHRlckNvbHVtbiA9IHRoaXMuZ2V0Q29sdW1uQnlOYW1lKGNvbHVtbk5hbWUpO1xuXG4gICAgaWYgKCFmaWx0ZXJDb2x1bW4pIHtcbiAgICAgIHRocm93IEVycm9yKGBDYW5ub3Qgc2V0IGZpbHRlciBmb3IgYSBjb2x1bW4uIENvbHVtbiB3aXRoIG5hbWUgJyR7Y29sdW1uTmFtZX0nIGRvZXMgbm90IGV4aXN0LmApO1xuICAgIH1cblxuICAgIHRoaXMuYXBwbGllZEZpbHRlcnNbZmlsdGVyQ29sdW1uLm5hbWVdID0gZmlsdGVyO1xuICAgIHRoaXMudXBkYXRlRGF0YVNvdXJjZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb2x1bW5CeU5hbWUoY29sdW1uTmFtZTogc3RyaW5nKTogQ29sdW1uQ29uZmlnIHtcbiAgICByZXR1cm4gdGhpcy5jb2x1bW5zLmZpbmQoYyA9PlxuICAgICAgKGMubmFtZSA/IGMubmFtZS50b0xvd2VyQ2FzZSgpIDogYy5uYW1lKSA9PT0gKGNvbHVtbk5hbWUgPyBjb2x1bW5OYW1lLnRvTG93ZXJDYXNlKCkgOiBjb2x1bW5OYW1lKVxuICAgICk7XG4gIH1cbn0iLCJpbXBvcnQgeyBEaXJlY3RpdmUsIFZpZXdDb250YWluZXJSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuQERpcmVjdGl2ZSh7XG4gICAgc2VsZWN0b3I6ICdbbWR0Q2VsbEhvc3RdJyxcbn0pXG5leHBvcnQgY2xhc3MgQ2VsbERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IocHVibGljIHZpZXdDb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYpIHt9XG59IiwiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2VsbENvbXBvbmVudCB9IGZyb20gJy4vY2VsbC5jb21wb25lbnQnO1xuaW1wb3J0IHsgQ29sdW1uQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29sdW1uLWNvbmZpZy5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbWR0LXRleHQtY2VsbCcsXG4gICAgdGVtcGxhdGU6ICd7eyByb3dbY29sdW1uLm5hbWVdIH19J1xufSlcbmV4cG9ydCBjbGFzcyBUZXh0Q2VsbENvbXBvbmVudCBpbXBsZW1lbnRzIENlbGxDb21wb25lbnQge1xuICAgIEBJbnB1dCgpIGNvbHVtbjogQ29sdW1uQ29uZmlnO1xuICAgIEBJbnB1dCgpIHJvdzogb2JqZWN0O1xufSIsImltcG9ydCB7IFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRleHRDZWxsQ29tcG9uZW50IH0gZnJvbSAnLi90ZXh0LWNlbGwuY29tcG9uZW50JztcblxuZXhwb3J0IGNsYXNzIENlbGxTZXJ2aWNlIHtcblxuICAgIHByaXZhdGUgcmVnaXN0ZXJlZENlbGxzOiB7IFtrZXk6IHN0cmluZ106IFR5cGU8YW55PjsgfSA9IHt9O1xuICAgIFxuICAgIHJlZ2lzdGVyQ2VsbCh0eXBlOiBzdHJpbmcsIGNvbXBvbmVudDogVHlwZTxhbnk+KSB7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZENlbGxzW3R5cGVdID0gY29tcG9uZW50O1xuICAgIH1cblxuICAgIGdldENlbGwodHlwZTogc3RyaW5nKTogVHlwZTxhbnk+IHtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcy5yZWdpc3RlcmVkQ2VsbHNbdHlwZV07XG5cbiAgICAgICAgaWYgKGNvbXBvbmVudCA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gVGV4dENlbGxDb21wb25lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xuICAgIH1cbn0iLCJpbXBvcnQgeyBDb21wb25lbnQsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5wdXQsIFZpZXdDaGlsZCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDZWxsRGlyZWN0aXZlIH0gZnJvbSAnLi9jZWxsLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBDZWxsU2VydmljZSB9IGZyb20gJy4vY2VsbC10eXBlcy9jZWxsLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ2VsbENvbXBvbmVudCB9IGZyb20gJy4vY2VsbC10eXBlcy9jZWxsLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBDb2x1bW5Db25maWcgfSBmcm9tICcuLi9jb2x1bW4tY29uZmlnLm1vZGVsJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdtZHQtdGFibGUtY2VsbCcsXG4gICAgdGVtcGxhdGU6ICc8bmctdGVtcGxhdGUgbWR0Q2VsbEhvc3Q+PC9uZy10ZW1wbGF0ZT4nXG59KVxuZXhwb3J0IGNsYXNzIFRhYmxlQ2VsbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gICAgQFZpZXdDaGlsZChDZWxsRGlyZWN0aXZlKSBjZWxsSG9zdDogQ2VsbERpcmVjdGl2ZTtcblxuICAgIEBJbnB1dCgpIHJvdzogb2JqZWN0O1xuICAgIEBJbnB1dCgpIGNvbHVtbjogQ29sdW1uQ29uZmlnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgY2VsbFNlcnZpY2U6IENlbGxTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IGNvbXBvbmVudEZhY3RvcnlSZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyKSB7IH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmluaXRDZWxsKCk7XG4gICAgfVxuXG4gICAgaW5pdENlbGwoKSB7XG4gICAgICAgIGNvbnN0IGNlbGxDb21wb25lbnQgPSB0aGlzLmNlbGxTZXJ2aWNlLmdldENlbGwodGhpcy5jb2x1bW4udHlwZSk7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudEZhY3RvcnkgPSB0aGlzLmNvbXBvbmVudEZhY3RvcnlSZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShjZWxsQ29tcG9uZW50KTtcbiAgICAgICAgY29uc3Qgdmlld0NvbnRhaW5lclJlZiA9IHRoaXMuY2VsbEhvc3Qudmlld0NvbnRhaW5lclJlZjtcbiAgICAgICAgdmlld0NvbnRhaW5lclJlZi5jbGVhcigpO1xuICAgICAgICBjb25zdCBjb21wb25lbnRSZWYgPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTtcbiAgICAgICAgY29uc3QgY2VsbCA9IGNvbXBvbmVudFJlZi5pbnN0YW5jZSBhcyBDZWxsQ29tcG9uZW50O1xuICAgICAgICBjZWxsLnJvdyA9IHRoaXMucm93O1xuICAgICAgICBjZWxsLmNvbHVtbiA9IHRoaXMuY29sdW1uO1xuICAgIH1cbn0iLCJleHBvcnQgY2xhc3MgQ29sdW1uQ29uZmlnIHtcclxuICAgIG5hbWU/OiBzdHJpbmc7XHJcbiAgICBkaXNwbGF5TmFtZT86IHN0cmluZztcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIG9wdGlvbnM/OiBhbnk7XHJcbiAgICBzdGlja3k/OiBzdHJpbmc7XHJcbiAgICBzb3J0PzogYm9vbGVhbjtcclxufSIsImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2VsbENvbXBvbmVudCB9IGZyb20gJy4vY2VsbC5jb21wb25lbnQnO1xuaW1wb3J0IHsgQ29sdW1uQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29sdW1uLWNvbmZpZy5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbWR0LWRhdGUtY2VsbCcsXG4gICAgdGVtcGxhdGU6ICd7eyByb3dbY29sdW1uLm5hbWVdIHwgZGF0ZTpkYXRlRm9ybWF0IH19J1xufSlcbmV4cG9ydCBjbGFzcyBEYXRlQ2VsbENvbXBvbmVudCBpbXBsZW1lbnRzIENlbGxDb21wb25lbnQsIE9uSW5pdCB7XG4gICAgQElucHV0KCkgY29sdW1uOiBDb2x1bW5Db25maWc7XG4gICAgQElucHV0KCkgcm93OiBvYmplY3Q7XG5cbiAgICBkYXRlRm9ybWF0ID0gJ3Nob3J0JztcblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICBpZiAodGhpcy5jb2x1bW4ub3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY29sdW1uLm9wdGlvbnMuZGF0ZUZvcm1hdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuY29sdW1uLm9wdGlvbnMuZGF0ZUZvcm1hdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHtcbiAgTWF0VGFibGVNb2R1bGUsXG4gIE1hdFNvcnRNb2R1bGUsXG4gIE1hdFBhZ2luYXRvck1vZHVsZSxcbiAgTWF0SWNvbk1vZHVsZSxcbiAgTWF0RGlhbG9nTW9kdWxlLFxuICBNYXRUb29sdGlwTW9kdWxlXG59IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcblxuaW1wb3J0IHsgRHluYW1pY1RhYmxlQ29tcG9uZW50IH0gZnJvbSAnLi9keW5hbWljLXRhYmxlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBUYWJsZUNlbGxDb21wb25lbnQgfSBmcm9tICcuL3RhYmxlLWNlbGwvdGFibGUtY2VsbC5jb21wb25lbnQnO1xuXG5pbXBvcnQgeyBDZWxsU2VydmljZSB9IGZyb20gJy4vdGFibGUtY2VsbC9jZWxsLXR5cGVzL2NlbGwuc2VydmljZSc7XG5pbXBvcnQgeyBDZWxsRGlyZWN0aXZlIH0gZnJvbSAnLi90YWJsZS1jZWxsL2NlbGwuZGlyZWN0aXZlJztcbmltcG9ydCB7IENvbHVtbkZpbHRlclNlcnZpY2UgfSBmcm9tICcuL3RhYmxlLWNlbGwvY2VsbC10eXBlcy9jb2x1bW4tZmlsdGVyLnNlcnZpY2UnO1xuXG5leHBvcnQgeyBDZWxsU2VydmljZSwgQ2VsbERpcmVjdGl2ZSwgQ29sdW1uRmlsdGVyU2VydmljZSB9O1xuZXhwb3J0IHsgQ2VsbENvbXBvbmVudCB9IGZyb20gJy4vdGFibGUtY2VsbC9jZWxsLXR5cGVzL2NlbGwuY29tcG9uZW50JztcbmV4cG9ydCB7IENvbHVtbkZpbHRlciB9IGZyb20gJy4vY29sdW1uLWZpbHRlci5tb2RlbCc7XG5leHBvcnQgeyBDb2x1bW5Db25maWcgfSBmcm9tICcuL2NvbHVtbi1jb25maWcubW9kZWwnO1xuZXhwb3J0IHsgRmlsdGVyRGVzY3JpcHRpb24gfSBmcm9tICcuL2ZpbHRlci1kZXNjcmlwdGlvbic7XG5cbmltcG9ydCB7IFRleHRDZWxsQ29tcG9uZW50IH0gZnJvbSAnLi90YWJsZS1jZWxsL2NlbGwtdHlwZXMvdGV4dC1jZWxsLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBEYXRlQ2VsbENvbXBvbmVudCB9IGZyb20gJy4vdGFibGUtY2VsbC9jZWxsLXR5cGVzL2RhdGUtY2VsbC5jb21wb25lbnQnO1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbXG4gICAgQ29tbW9uTW9kdWxlLFxuICAgIE1hdFRhYmxlTW9kdWxlLFxuICAgIE1hdFNvcnRNb2R1bGUsXG4gICAgTWF0UGFnaW5hdG9yTW9kdWxlLFxuICAgIE1hdEljb25Nb2R1bGUsXG4gICAgTWF0RGlhbG9nTW9kdWxlLFxuICAgIE1hdFRvb2x0aXBNb2R1bGVcbiAgXSxcbiAgZGVjbGFyYXRpb25zOiBbXG4gICAgRHluYW1pY1RhYmxlQ29tcG9uZW50LFxuICAgIFRhYmxlQ2VsbENvbXBvbmVudCxcbiAgICBDZWxsRGlyZWN0aXZlLFxuICAgIFRleHRDZWxsQ29tcG9uZW50LFxuICAgIERhdGVDZWxsQ29tcG9uZW50XG4gIF0sXG4gIGV4cG9ydHM6IFtEeW5hbWljVGFibGVDb21wb25lbnRdLFxuICBlbnRyeUNvbXBvbmVudHM6IFtcbiAgICBUZXh0Q2VsbENvbXBvbmVudCxcbiAgICBEYXRlQ2VsbENvbXBvbmVudFxuICBdLFxuICBwcm92aWRlcnM6IFtcbiAgICBDZWxsU2VydmljZSxcbiAgICBDb2x1bW5GaWx0ZXJTZXJ2aWNlXG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgRHluYW1pY1RhYmxlTW9kdWxlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBjZWxsU2VydmljZTogQ2VsbFNlcnZpY2UpIHtcbiAgICBjZWxsU2VydmljZS5yZWdpc3RlckNlbGwoJ3N0cmluZycsIFRleHRDZWxsQ29tcG9uZW50KTtcbiAgICBjZWxsU2VydmljZS5yZWdpc3RlckNlbGwoJ2RhdGUnLCBEYXRlQ2VsbENvbXBvbmVudCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJNYXREaWFsb2dDb25maWciLCJDb21wb25lbnQiLCJNYXREaWFsb2ciLCJJbnB1dCIsIlZpZXdDaGlsZCIsIk1hdFNvcnQiLCJNYXRQYWdpbmF0b3IiLCJEaXJlY3RpdmUiLCJWaWV3Q29udGFpbmVyUmVmIiwiQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyIiwiTmdNb2R1bGUiLCJDb21tb25Nb2R1bGUiLCJNYXRUYWJsZU1vZHVsZSIsIk1hdFNvcnRNb2R1bGUiLCJNYXRQYWdpbmF0b3JNb2R1bGUiLCJNYXRJY29uTW9kdWxlIiwiTWF0RGlhbG9nTW9kdWxlIiwiTWF0VG9vbHRpcE1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUVBO1FBQUE7U0FHQztRQUFELG1CQUFDO0lBQUQsQ0FBQzs7Ozs7O0FDSEQ7UUFBQTtZQUVZLHNCQUFpQixHQUFrQyxFQUFFLENBQUM7U0FXakU7Ozs7OztRQVRHLDRDQUFjOzs7OztZQUFkLFVBQWUsSUFBWSxFQUFFLFNBQW9CO2dCQUM3QyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEdBQUcsU0FBUyxDQUFDO2FBQzVDOzs7OztRQUVELHVDQUFTOzs7O1lBQVQsVUFBVSxJQUFZOztvQkFDWixTQUFTLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQztnQkFFOUMsT0FBTyxTQUFTLENBQUM7YUFDcEI7UUFDTCwwQkFBQztJQUFELENBQUM7Ozs7OztBQ2ZEO1FBNkJFLCtCQUE2QixtQkFBd0MsRUFBbUIsTUFBaUI7WUFBNUUsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUFxQjtZQUFtQixXQUFNLEdBQU4sTUFBTSxDQUFXO1lBYmhHLGFBQVEsR0FBRyxFQUFFLENBQUM7WUFDZCxvQkFBZSxHQUFH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